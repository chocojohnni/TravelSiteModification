@model TravelSiteModification.Models.HotelSearchViewModel

@{
    ViewData["Title"] = "Hotel Search Results";
}

<div class="container py-5">
    <h1 class="mb-4">Hotel Search Results</h1>

    @if (!string.IsNullOrEmpty(Model.ErrorMessage) && (Model.Results == null || Model.Results.Count == 0))
    {
        <div class="alert alert-warning">@Model.ErrorMessage</div>
    }

    <!-- Refine Search -->
    <form asp-action="Index" method="post">
        <div class="p-3 mb-4 border rounded-3 bg-light">
            <h5 class="fw-bold mb-3">Refine Your Search</h5>

            <div class="row g-3 mb-3">
                <div class="col-md-6">
                    <label class="form-label mb-0" for="Destination">Destination City/State</label>
                    <select asp-for="Destination" asp-items="Model.Destinations" class="form-select"></select>
                </div>
                <div class="col-md-3">
                    <label class="form-label mb-0" asp-for="CheckInDate">Check-in Date</label>
                    <input asp-for="CheckInDate" type="date" class="form-control" />
                </div>
                <div class="col-md-3">
                    <label class="form-label mb-0" asp-for="CheckOutDate">Check-out Date</label>
                    <input asp-for="CheckOutDate" type="date" class="form-control" />
                </div>
            </div>

            <div class="row g-3 align-items-end">
                <div class="col-md-6 text-end">
                    <button type="submit" class="btn btn-warning">Update Search</button>
                </div>
            </div>

            @if (!string.IsNullOrEmpty(Model.ErrorMessage) && Model.Results != null && Model.Results.Count > 0)
            {
                <p class="text-danger mt-2">@Model.ErrorMessage</p>
            }
        </div>
    </form>

    @if (!string.IsNullOrEmpty(Model.SearchCriteriaMessage))
    {
        <div class="mb-3">
            @Html.Raw(Model.SearchCriteriaMessage)
        </div>
    }

    <hr />

    @if (Model.Results != null && Model.Results.Count > 0)
    {
        <table class="table table-bordered table-striped mt-4">
            <thead class="table-dark">
                <tr>
                    <th>Hotel</th>
                    <th>Description</th>
                    <th>Rating</th>
                    <th class="text-end">Price/Night</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var hotel in Model.Results)
                {
                    <tr>
                        <td>
                            <div class="d-flex align-items-center">
                                @if (!string.IsNullOrEmpty(hotel.ImagePath))
                                {
                                    <img src="@hotel.ImagePath"
                                         alt="@hotel.HotelName"
                                         height="100" width="160"
                                         class="me-3 rounded" />
                                }
                                <div>
                                    <h5 class="fw-bold mb-0">@hotel.HotelName</h5>
                                    <span class="text-muted">@hotel.City</span>
                                </div>
                            </div>
                        </td>
                        <td style="width:300px;">@hotel.Description</td>
                        <td>@(hotel.Rating.HasValue? hotel.Rating.Value.ToString("0.0") : "N/A")</td>
                        <td class="text-end">@hotel.PricePerNight.ToString("C")</td>
                        <td>
                            <a asp-action="Details"
                               asp-route-hotelId="@hotel.HotelID"
                               class="btn btn-success btn-sm">
                                View Rooms
                            </a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else if (string.IsNullOrEmpty(Model.ErrorMessage))
    {
        <p class="alert alert-info mt-3">No hotels were found matching your criteria.</p>
    }
</div>
